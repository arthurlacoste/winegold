<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>winegold</title>
    <link rel="stylesheet" href="assets/style.css">
  </head>
  <body>
    <div id="content">
      <div id="droptarget" class="droptargetNotDragged"><svg id="picDrop" class="svgNotDragged" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 43"><path d="M48.4 26.5c-.9 0-1.7.7-1.7 1.7v11.6h-43.3v-11.6c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v13.2c0 .9.7 1.7 1.7 1.7h46.7c.9 0 1.7-.7 1.7-1.7v-13.2c0-1-.7-1.7-1.7-1.7zm-24.5 6.1c.3.3.8.5 1.2.5.4 0 .9-.2 1.2-.5l10-11.6c.7-.7.7-1.7 0-2.4s-1.7-.7-2.4 0l-7.1 8.3v-25.3c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v25.3l-7.1-8.3c-.7-.7-1.7-.7-2.4 0s-.7 1.7 0 2.4l10 11.6z"></path></svg></div>
    </div>
    <script>
    const ipc = require('electron').ipcRenderer
    function setImgOpacity(value){
      if (value===true){
        document.getElementById("picDrop").setAttribute("class","svgDragover");
        document.getElementById("droptarget").className = "droptargetDragover";
    } else {
        document.getElementById("picDrop").setAttribute("class","svgNotDragged");
        document.getElementById("droptarget").className = "droptargetNotDragged";
      }
    }

    function loadList() {
      document.getElementById("content").innerHTML='<object type="text/html" data="assets/list.html" ></object>';
    }

    (function () {
        var holder = document.getElementById('content');

        holder.ondragover = () => {
            setImgOpacity(true);
            return false;
        };

        holder.ondragleave = () => {
            setImgOpacity(false);
            return false;
        };

        holder.ondragend = () => {
            setImgOpacity(false);
            return false;
        };

        holder.ondrop = (e) => {
            e.preventDefault();
            // console.log(e.dataTransfer.files[0]);

            for (let f of e.dataTransfer.files) {

                console.log(f.path);

                ipc.send('asynchronous-message', f.path)


                ipc.on('asynchronous-reply', function (event, arg) {
                  const message = `Asynchronous message reply: ${arg}`
                  document.getElementById('async-reply').innerHTML = message

                })
            }
            loadList();
            setImgOpacity(false);
            document.body.style.cursor =  "";
            return false;
        };
    })();

    </script>

  </body>
</html>
